# Система детального просмотра уровня

## Обзор
Данный документ описывает систему детального просмотра уровня, где пользователи получают доступ к обучающему контенту и взаимодействуют с ним.

## Компоненты

### 1. VideoPlayer
- Отображает встроенные YouTube-видео
- Отслеживает прогресс просмотра
- Автоматически отмечает видео как просмотренные при достижении 90% просмотра
- Предоставляет возможность вручную отметить видео как просмотренное

### 2. TestModule
- Интерактивные тесты с вопросами и вариантами ответов
- Отслеживание прогресса по вопросам
- Предоставление результатов и баллов после завершения
- Отображение правильных ответов для пропущенных вопросов

### 3. ArtifactDownload
- Загружаемые ресурсы, связанные с уровнем
- Отображение типа файла и описания
- Отслеживание статуса загрузки
- Различное стилевое оформление для загруженных артефактов

### 4. LockedLevel
- Компонент для отображения заблокированного уровня
- Указание причины блокировки (необходимо завершить предыдущие уровни)
- Информация о премиум-статусе, если уровень требует подписки

### 5. LoadingState
- Универсальный компонент для отображения состояния загрузки
- Анимированный индикатор
- Опциональное текстовое сообщение

## Управление данными

### Хук useLevel
- Пользовательский хук для работы с данными отдельного уровня
- Управляет прогрессом видео, завершением тестов и загрузкой артефактов
- Предоставляет функции для обновления прогресса
- Отслеживает общий статус завершения уровня
- Контролирует логику разблокировки уровней

### Хук useLevels
- Пользовательский хук для работы со списком уровней
- Получает статусы всех уровней
- Определяет, какие уровни доступны, заблокированы или завершены
- Предоставляет функции для проверки статусов уровней

## Логика прогресса уровней

### Требования для завершения уровня
- Просмотреть все видео
- Пройти все тесты
- Загрузить все артефакты
- Нажать кнопку "Завершить уровень"

### Состояния уровня
- Заблокирован: Пользователь не завершил предыдущие уровни
- Доступен: Пользователь может получить доступ к контенту уровня
- Завершен: Пользователь выполнил все требования

## Организация контента

### Поток контента
1. Видео представляют концепции и навыки
2. Тесты появляются после соответствующих видео для проверки понимания
3. Артефакты предоставляют практические инструменты и шаблоны
4. Кнопка завершения становится доступной после выполнения всех требований

### Отслеживание взаимодействия
- Прогресс просмотра видео отслеживается и сохраняется
- Завершения тестов регистрируются вместе с баллами
- Загрузки артефактов отслеживаются
- Общий прогресс визуализируется в виде прогресс-бара

## Детали реализации
- React-компоненты с TypeScript
- Встраивание YouTube для видео
- Интерактивный интерфейс тестов с немедленной обратной связью
- Имитация загрузки файлов (в демо-версии)
- Отслеживание прогресса с локальным состоянием (в продакшне будет использоваться Firestore)

## Пример использования

```tsx
import { useLevel } from '@/hooks/useLevel';
import { VideoPlayer } from '@/components/features/level/VideoPlayer';

function VideoSection({ videoId }: { videoId: string }) {
  const { 
    videoProgress, 
    markVideoWatched, 
    updateVideoPosition 
  } = useLevel('level-1');
  
  return (
    <VideoPlayer
      video={{
        id: videoId,
        title: "Введение в бизнес-планирование",
        description: "Основы создания бизнес-планов",
        youtubeId: "dQw4w9WgXcQ",
        duration: 180,
        order: 1
      }}
      progress={videoProgress[videoId]}
      onVideoComplete={() => markVideoWatched(videoId)}
      onPositionChange={(position) => updateVideoPosition(videoId, position)}
    />
  );
}
``` 